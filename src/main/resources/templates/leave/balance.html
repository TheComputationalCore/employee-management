<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">

<head>
    <title>Leave Balance</title>
    <script src="https://unpkg.com/feather-icons"></script>

    <style>

        .balance-header-card {
            background: var(--card-bg);
            padding: 22px;
            border-radius: 14px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
            margin-bottom: 25px;
        }

        .balance-card {
            border-radius: 14px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            padding: 20px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.05);
            transition: .2s ease;
        }

        .balance-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .quota-card {
            padding: 22px;
            border-radius: 14px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            box-shadow: 0 3px 12px rgba(0,0,0,0.05);
        }

        .table th {
            background: var(--light);
            font-weight: 600;
        }

        .label-sm {
            font-size: 0.9rem;
            font-weight: 600;
            display: block;
            margin-bottom: 5px;
        }

    </style>

</head>

<body>

<main layout:fragment="content">

    <!-- HEADER CARD -->
    <div class="balance-header-card">

        <h3 class="fw-semibold mb-1">
            <i data-feather="user-check" class="me-2"></i>
            Leave Balance
        </h3>

        <p class="text-muted mb-0">
            Employee:
            <strong th:text="${employee.firstName + ' ' + employee.lastName}"></strong>
        </p>
    </div>


    <!-- BALANCE TABLE -->
    <div class="balance-card mb-4">

        <h5 class="fw-semibold mb-3">
            <i data-feather="list" class="me-2"></i>
            Current Leave Balances
        </h5>

        <table class="table table-hover align-middle">
            <thead>
            <tr>
                <th>Leave Type</th>
                <th>Total Days</th>
                <th>Remaining</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="b : ${balances}">
                <td th:text="${b.type}"></td>
                <td th:text="${b.totalDays}"></td>
                <td>
                    <span class="badge"
                          th:class="'px-3 py-2 ' +
                                   (${b.remainingDays} == 0 ? 'bg-danger' :
                                    ${b.remainingDays} < 3 ? 'bg-warning text-dark' :
                                    'bg-success')"
                          th:text="${b.remainingDays + ' days'}">
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>


    <!-- QUOTA SETTING -->
    <div class="quota-card">

        <h5 class="fw-semibold mb-3">
            <i data-feather="sliders" class="me-2"></i>
            Set / Update Leave Quota
        </h5>

        <form method="post" th:action="@{/web/leave-balance/set}">

            <!-- REQUIRED CSRF TOKEN -->
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

            <input type="hidden" name="employeeId" th:value="${employee.id}">

            <div class="row g-3">

                <!-- Leave Type -->
                <div class="col-md-4">
                    <label class="label-sm">Leave Type</label>
                    <select class="form-select" name="type" required>
                        <option th:each="t : ${types}"
                                th:value="${t}"
                                th:text="${t}">
                        </option>
                    </select>
                </div>

                <!-- Total Days -->
                <div class="col-md-4">
                    <label class="label-sm">Total Days</label>
                    <input type="number" class="form-control" name="totalDays" min="0" required>
                </div>

                <!-- Submit -->
                <div class="col-md-4">
                    <label class="label-sm">&nbsp;</label>
                    <button class="btn btn-primary w-100 d-flex align-items-center justify-content-center">
                        <i data-feather="save" class="me-1"></i> Save Quota
                    </button>
                </div>

            </div>

        </form>

    </div>

</main>

<script>
    feather.replace();
</script>

</body>
</html>
