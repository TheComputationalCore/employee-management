<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">

<!-- ======================= -->
<!-- PAGE CONTENT -->
<!-- ======================= -->
<div layout:fragment="content">

    <style>
        .fc .fc-toolbar-title {
            font-weight: 600;
            font-size: 1.4rem;
        }

        .fc-event {
            border-radius: 8px;
            padding: 4px 6px;
            font-size: 0.85rem;
            border: none !important;
        }

        .fc-event:hover {
            opacity: 0.90;
            cursor: pointer;
        }
    </style>

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-semibold">Interview Scheduling</h2>

        <a th:href="@{/web/recruitment/jobs}" class="btn btn-outline-primary">
            <i data-feather="arrow-left" class="me-1"></i> Back to Jobs
        </a>
    </div>

    <!-- CALENDAR -->
    <div class="card shadow-sm p-4" style="border-radius: 16px;">
        <div id="interviewCalendar"></div>
    </div>

</div>

<!-- ======================= -->
<!-- SCRIPTS (Injected into main.html) -->
<!-- ======================= -->
<div layout:fragment="scripts">

    <!-- FullCalendar -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap5@6.1.10/index.global.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {

            const events = /*[[${events}]]*/ [];
            const calendarEl = document.getElementById("interviewCalendar");

            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                themeSystem: 'bootstrap5',
                height: "auto",

                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek'
                },

                events: events,

                eventClick: function (info) {
                    const id = info.event.extendedProps.interviewId;
                    window.location.href = "/web/recruitment/interview/view/" + id;
                },

                eventContent: function (arg) {
                    const type = arg.event.extendedProps.type;
                    const candidate = arg.event.extendedProps.candidate;

                    let bg = "#4f46e5";
                    if (type === "Technical") bg = "#0284c7";
                    if (type === "HR") bg = "#10b981";
                    if (type === "Manager") bg = "#f59e0b";

                    return {
                        html: `
                            <div style="
                                background:${bg};
                                color:#fff;
                                padding:3px 6px;
                                border-radius:6px;
                            ">
                                <strong>${candidate}</strong><br>
                                ${type}
                            </div>
                        `
                    };
                },

            });

            calendar.render();
        });
    </script>

    <script src="https://unpkg.com/feather-icons"></script>
    <script>feather.replace()</script>

</div>

</html>
