<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">

<head>
    <script src="https://unpkg.com/feather-icons"></script>

    <style>
        .career-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .career-search {
            max-width: 320px;
        }

        .job-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 22px;
            margin-bottom: 20px;
            transition: .25s ease;
        }

        .job-card:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: 0 6px 16px rgba(0,0,0,0.08);
        }

        .job-title {
            font-weight: 700;
            font-size: 1.15rem;
        }

        .job-meta {
            font-size: 0.87rem;
            color: gray;
            display: flex;
            gap: 18px;
            margin-top: 6px;
        }

        .job-meta i {
            width: 15px;
            height: 15px;
            margin-right: 4px;
        }
    </style>
</head>

<body>

<div layout:fragment="content">

    <div class="career-header mb-4">
        <h2 class="fw-semibold">Open Positions</h2>

        <input id="searchInput"
               type="text"
               class="form-control career-search"
               placeholder="Search roles...">
    </div>

    <div id="jobsContainer">

        <div th:each="j : ${jobs}" class="job-card">

            <div class="d-flex justify-content-between align-items-center">

                <div>
                    <div class="job-title" th:text="${j.title}"></div>

                    <div class="job-meta">

                        <div>
                            <i data-feather="map-pin"></i>
                            <span th:text="${j.location}">Location</span>
                        </div>

                        <div th:if="${j.department != null}">
                            <i data-feather="briefcase"></i>
                            <span th:text="${j.department}"></span>
                        </div>

                        <div th:if="${j.employmentType != null}">
                            <i data-feather="clock"></i>
                            <span th:text="${j.employmentType}"></span>
                        </div>

                    </div>
                </div>

                <div>
                    <a class="btn btn-primary"
                       th:href="@{'/careers/job/' + ${j.id}}">
                        View <i data-feather="arrow-right" class="ms-1"></i>
                    </a>
                </div>

            </div>

        </div>

    </div>

</div>

<script>
    feather.replace();

    document.getElementById("searchInput").addEventListener("input", function () {
        const search = this.value.toLowerCase();
        const cards = document.querySelectorAll("#jobsContainer .job-card");

        cards.forEach(card => {
            const text = card.innerText.toLowerCase();
            card.style.display = text.includes(search) ? "" : "none";
        });
    });
</script>

</body>
</html>
